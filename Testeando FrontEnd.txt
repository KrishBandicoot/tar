# ğŸ§ª GuÃ­a de Testing - Kkarhua Frontend

## ğŸ“‹ DescripciÃ³n

Este proyecto incluye pruebas unitarias e integraciÃ³n utilizando:
- **Vitest**: Framework de testing rÃ¡pido y moderno
- **React Testing Library**: Testing de componentes React
- **Jest DOM**: Matchers adicionales para el DOM

## ğŸš€ Comandos de Testing

### Ejecutar todos los tests
```bash
npm test
```

### Ejecutar tests en modo watch (re-ejecuta al cambiar archivos)
```bash
npm run test:watch
```

### Ejecutar tests una sola vez
```bash
npm run test:run
```

### Ejecutar tests con interfaz grÃ¡fica
```bash
npm run test:ui
```

### Generar reporte de cobertura
```bash
npm run test:cov
```

### Ver cobertura con interfaz grÃ¡fica
```bash
npm run test:cov:ui
```

## ğŸ“Š Estructura de Tests

```
src/
â”œâ”€â”€ context/
â”‚   â”œâ”€â”€ AuthContext.test.jsx       âœ… Tests del contexto de autenticaciÃ³n
â”‚   â””â”€â”€ CarritoContext.test.jsx    âœ… Tests del carrito de compras
â”œâ”€â”€ componentes/
â”‚   â”œâ”€â”€ Navbar/
â”‚   â”‚   â””â”€â”€ Navbar.test.jsx        âœ… Tests del componente Navbar
â”‚   â””â”€â”€ Footer/
â”‚       â””â”€â”€ Footer.test.jsx        âœ… Tests del componente Footer
â””â”€â”€ pages/
    â””â”€â”€ Home/
        â””â”€â”€ Home.integration.test.jsx âœ… Tests de integraciÃ³n de Home
```

## âœ… Tests Implementados

### 1. **CarritoContext.test.jsx** (5 tests)
- âœ… Agregar productos al carrito
- âœ… Actualizar cantidad de productos
- âœ… Eliminar productos del carrito
- âœ… Vaciar carrito completamente
- âœ… Persistencia en localStorage

### 2. **AuthContext.test.jsx** (5 tests)
- âœ… Estado inicial no autenticado
- âœ… AutenticaciÃ³n de usuario
- âœ… Cierre de sesiÃ³n
- âœ… Persistencia de sesiÃ³n
- âœ… Manejo de datos corruptos

### 3. **Navbar.test.jsx** (7 tests)
- âœ… Renderizado de enlaces
- âœ… Badge del carrito con cantidad
- âœ… Badge oculto con carrito vacÃ­o
- âœ… NavegaciÃ³n al carrito
- âœ… Atributos href correctos
- âœ… Cierre de menÃº mÃ³vil

### 4. **Footer.test.jsx** (10 tests)
- âœ… Renderizado de contenido
- âœ… Enlaces de navegaciÃ³n
- âœ… Iconos de redes sociales
- âœ… Copyright con aÃ±o actual
- âœ… Estructura Bootstrap
- âœ… Responsividad

### 5. **Home.integration.test.jsx** (10 tests)
- âœ… Carga de productos desde API
- âœ… Manejo de errores de red
- âœ… Reintentar carga de productos
- âœ… Formato de precios
- âœ… Enlaces de autenticaciÃ³n
- âœ… InformaciÃ³n de usuario autenticado
- âœ… BotÃ³n de admin para super-admin
- âœ… Truncado de descripciones
- âœ… Productos sin imagen

## ğŸ“ˆ Cobertura Esperada

Los tests cubren:
- **Contextos**: AuthContext y CarritoContext
- **Componentes**: Navbar y Footer
- **PÃ¡ginas**: Home (integraciÃ³n completa)
- **Funcionalidades clave**: AutenticaciÃ³n, carrito, navegaciÃ³n

### Umbrales de Cobertura
- Lines: 60%
- Functions: 60%
- Branches: 60%
- Statements: 60%

## ğŸ”§ ConfiguraciÃ³n

### vite.config.js
```javascript
test: {
  environment: 'jsdom',
  setupFiles: ['./src/test/setupTests.ts'],
  globals: true,
  coverage: {
    provider: 'v8',
    reporter: ['text', 'html', 'json', 'lcov'],
    reportsDirectory: './coverage',
    thresholds: {
      lines: 60,
      functions: 60,
      branches: 60,
      statements: 60
    }
  }
}
```

## ğŸ“ Ejemplo de Test

```javascript
import { describe, it, expect } from 'vitest'
import { render, screen } from '@testing-library/react'
import userEvent from '@testing-library/user-event'

describe('MiComponente', () => {
  it('debe renderizar correctamente', () => {
    render(<MiComponente />)
    expect(screen.getByText('Hola')).toBeInTheDocument()
  })

  it('debe manejar clicks', async () => {
    const user = userEvent.setup()
    render(<MiComponente />)
    
    await user.click(screen.getByRole('button'))
    
    expect(screen.getByText('Clicked')).toBeInTheDocument()
  })
})
```

## ğŸ› Debugging Tests

### Ver output detallado
```bash
npm test -- --reporter=verbose
```

### Ejecutar un solo archivo
```bash
npm test -- CarritoContext.test.jsx
```

### Ejecutar tests que coincidan con un patrÃ³n
```bash
npm test -- -t "debe agregar productos"
```

## ğŸ“š Recursos

- [Vitest Documentation](https://vitest.dev/)
- [React Testing Library](https://testing-library.com/react)
- [Testing Library Queries](https://testing-library.com/docs/queries/about)
- [Jest DOM Matchers](https://github.com/testing-library/jest-dom)

## ğŸ¯ Mejores PrÃ¡cticas

1. **Prueba comportamiento, no implementaciÃ³n**
2. **Usa queries semÃ¡nticas** (getByRole, getByLabelText)
3. **Usa userEvent** en lugar de fireEvent
4. **AÃ­sla cada test** (no compartas estado)
5. **Limpia despuÃ©s de cada test** (clearMocks, resetAllMocks)
6. **Usa waitFor** para operaciones asÃ­ncronas
7. **Mock solo lo necesario** (evita over-mocking)

## ğŸ” CI/CD (Opcional)

### GitHub Actions Example
```yaml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run test:run
      - run: npm run test:cov
      - uses: codecov/codecov-action@v3
```

